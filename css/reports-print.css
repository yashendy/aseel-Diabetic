:root{
  --bg:#f7fbff; --card:#fff; --ink:#111827; --muted:#6b7280;
  --border:#e5e7eb; --brand:#4f46e5; --ok:#10b981; --warn:#ef4444; --info:#2563eb;
}

*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:"Segoe UI",Tahoma,Arial,sans-serif}
.container{max-width:1120px;margin:16px auto;padding:0 12px}

.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:14px}

.header{display:grid;grid-template-columns:1fr 2fr 1fr;gap:12px;align-items:center}
.left{display:flex;gap:10px;align-items:center}
.center{text-align:center}
.right{display:flex;gap:8px;align-items:center;justify-content:flex-end;flex-wrap:wrap}

.btn{border:1px solid var(--border);background:#fff;border-radius:8px;padding:8px 12px;cursor:pointer}
.btn.primary{background:var(--brand);border-color:var(--brand);color:#fff}
.btn.back{background:#eef0ff;border-color:var(--brand);color:var(--brand)}

.muted{color:var(--muted);margin:6px 0 0}
.chips{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin-top:6px}
.chip{background:#eef2ff;border:1px solid #c7d2fe;color:#3730a3;padding:4px 10px;border-radius:999px;font-size:12px}
.chip.small{font-size:11px}

.filters .row{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
.filters input[type="date"], .controls select{padding:8px 10px;border:1px solid var(--border);border-radius:10px}
.ctl{display:flex;gap:6px;align-items:center}

.legend{display:flex;align-items:center;gap:8px;margin-inline-start:auto}
.lg{padding:4px 8px;border-radius:999px;font-size:12px;border:1px solid var(--border);background:#fafafa}
.lg.low{color:var(--info);background:#e8f2ff;border-color:#d7e7ff}
.lg.ok{color:var(--ok);background:#eafff4;border-color:#d8f7e7}
.lg.high{color:var(--warn);background:#fff1f1;border-color:#ffe1e1}

table.report{width:100%;border-collapse:collapse}
table.report th,table.report td{border:1px solid var(--border);padding:10px;vertical-align:top}
table.report thead th{background:#f7f7fb;text-align:center}
td.details .line{display:block;margin:2px 0}
td.details .val{font-weight:700}
td.details .val.low{color:var(--info)}
td.details .val.ok{color:var(--ok)}
td.details .val.high{color:var(--warn)}
.arrow{font-weight:700;margin-inline:2px}
.notesLine{color:#374151}
.notesLine.hidden{display:none}

tr.state-low{background:#f0f7ff}
tr.state-ok{background:#f6fffa}
tr.state-high{background:#fff6f6}

.qr{display:flex;flex-direction:column;align-items:center;gap:4px;margin-top:6px}
.qr-caption{font-size:10px;color:#64748b}

.loader{
  position:fixed;inset-inline:0;bottom:14px;margin:auto;width:230px;text-align:center;
  background:#111827;color:#fff;padding:10px 12px;border-radius:10px;opacity:.92;z-index:9999
}
.hidden{display:none}

/* ===== الطباعة ===== */
@media print {
  body{background:#fff}
  .card{box-shadow:none}
  .controls, .btn.back, .filters .row .btn, .legend .chip.small { display:none !important; }
  .container{max-width:100%;margin:0;padding:0}
  .header, .filters, .card{border:none}
  /* إخفاء سناك في الطباعة فقط */
  tr.is-snack{display:none !important;}
  /* تحجيم نظيف */
  table.report th,table.report td{padding:8px}
}
