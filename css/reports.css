:root{
  --bg:#f7f8fb; --card:#fff; --muted:#6b7280; --ink:#0f172a;
  --brand:#4f46e5; --ok:#16a34a; --warn:#f59e0b; --danger:#ef4444;
  --shadow:0 6px 24px rgba(15,23,42,.06), 0 2px 8px rgba(15,23,42,.04);
  --radius:14px;
  --print-zoom:1;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans Arabic",Tahoma,Arial,sans-serif}
.wrap{max-width:1200px;margin-inline:auto;padding:14px}

/* Top */
.topbar{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:10px}
.btn{height:40px;padding:0 14px;border:none;border-radius:10px;cursor:pointer;box-shadow:var(--shadow);background:#fff}
.btn--brand{background:var(--brand);color:#fff}
.btn--ok{background:var(--ok);color:#fff}
.btn--warn{background:#f59e0b;color:#111}
.btn--danger{background:#ef4444;color:#fff}
.btn--ghost{background:#fff;color:#1f2937;border:1px solid #e5e7eb}
.btn:hover{filter:brightness(.98)}
.chk{display:flex;gap:6px;align-items:center}
.zoom{display:flex;gap:8px;align-items:center}
.zoom input{width:140px}

.toolbar{display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:end;margin-bottom:10px}
.range{display:flex;gap:10px;align-items:end}
.field{display:flex;flex-direction:column;gap:6px}
.field>span{font-size:12px;color:var(--muted)}
.field input[type="date"]{height:40px;border:1px solid #e5e7eb;border-radius:10px;padding:0 10px;background:#fff}
.quick-range .chip{margin-inline-start:6px}
.actions{display:flex;gap:6px;justify-content:flex-end}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#eef2ff;font-size:12.5px}
.chip.b-ok{background:#dcfce7}
.chip.b-low{background:#fee2e2}
.chip.b-high{background:#fff7ed}
.chip.b-sevhigh{background:#fde68a}
.chip.b-crit{background:#ffe7e7}

/* Stats */
.stats-bar{display:flex;justify-content:space-between;align-items:center;margin:8px 0}
.cards{display:flex;gap:8px;flex-wrap:wrap}
.card{background:#fff;border:1px solid #eef2f7;border-radius:12px;padding:8px 12px;min-width:100px;box-shadow:var(--shadow)}
.card .k{font-size:12px;color:#64748b}
.low{background:#fef2f2}
.high{background:#fff7ed}
.crit{background:#ffe7e7}
.spark{height:48px;display:flex;align-items:center;justify-content:flex-end}

/* Views */
.view.hidden{display:none}
.sheet{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:12px}
.sheet-head .line{margin-bottom:4px}
.muted{color:var(--muted)}
.report-wrapper{padding:10px}
.report-scroll{overflow:auto;border-radius:10px;border:1px solid #eef2f7}

/* ===== Report Table: شبكة + تلوين الخانات ===== */
.report-table{
  width:100%;
  border-collapse:collapse;      /* شبكة كاملة */
  table-layout:fixed;
  background:#fff;
}
.report-table th,.report-table td{
  padding:8px;
  border:1px solid #e5e7eb;      /* تسطير كل الخلايا */
  vertical-align:top;
}
.report-table thead th{
  position:sticky; top:0; z-index:2;
  background:#fff;
}
.report-table th:first-child,
.report-table td:first-child{
  position:sticky; right:0; z-index:1;
  background:#fff;                /* يبقى عنوان التاريخ أبيض */
  border-left:1px solid #e5e7eb;
}

/* لون الخانة حسب الحالة (خلفية ناعمة) */
.report-table td.td-ok   { background:#dcfce7; } /* داخل النطاق = أخضر فاتح */
.report-table td.td-low  { background:#e0f2fe; } /* هبوط = أزرق فاتح */
.report-table td.td-high { background:#fee2e2; } /* ارتفاع = أحمر فاتح */
.report-table td.td-sev  { background:#fde68a; } /* ارتفاع شديد = أصفر فاتح */
.report-table td.td-crit { background:#ffe4e6; } /* حرج = وردي فاتح */

.c-val{display:block;font-family:ui-monospace,ConConsolas,monospace}
.c-note{display:block;color:#64748b;margin-top:4px;font-size:12px}
.badge{display:inline-flex;align-items:center;height:24px;padding:0 8px;border-radius:999px;background:#eef2ff;font-size:12px;margin-inline-end:6px}

/* Analytics placeholder/Grid helpers */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.panel{background:#fff;border:1px solid #eef2f7;border-radius:12px;padding:10px}

/* Toast */
.toast{position:fixed;inset-inline:0;bottom:16px;margin-inline:auto;background:#111827;color:#fff;padding:10px 14px;border-radius:999px;width:max-content;box-shadow:var(--shadow);z-index:50}

/* ====== Blank Week Sheet ====== */
.blank-sheet { background:#fff; border-radius:14px; padding:10px; }
.section-title { margin:8px 0 6px; font-size:14px; }
.blank-grid{
  --left-col: 120px;
  display:grid;
  grid-template-columns: var(--left-col) repeat(7, 1fr);
  border:1px solid #111; border-right:0; border-bottom:0;
}
.blank-grid > div{
  min-height:28mm;border-right:1px solid #111;border-bottom:1px solid #111;padding:6px;background:#fff;
}
.blank-grid .head{min-height:auto;background:#f8fafc;font-weight:600}
.blank-grid .row-label{background:#f9fafb;font-weight:600}

.blank-notes-grid{
  display:grid; grid-template-columns:120px repeat(7, 1fr);
  border:1px solid #111;border-right:0;border-bottom:0;
}
.blank-notes-grid > div{
  min-height:22mm;border-right:1px solid #111;border-bottom:1px solid #111;padding:6px;background:#fff;
}
.blank-notes-grid .row-label{background:#f9fafb;font-weight:600}

/* ====== Print (A4 Landscape) ====== */
@page { size: A4 landscape; margin: 8mm; }
@media print{
  html,body{width:297mm;height:210mm;-webkit-print-color-adjust:exact;print-color-adjust:exact}
  .topbar,.toolbar,.actions,.zoom,.quick-range,.btn,
  #btnBack,#btnShow,#btnAnalytics,#btnPrintPage,#btnPrint,#btnBlankWeek,#btnExportPDF,#btnExportCSV,#btnExportXLSX{display:none!important}
  body{zoom:var(--print-zoom)}
  .report-wrapper,.sheet{padding:0 6mm!important;box-shadow:none!important}
  thead{display:table-header-group}
  tfoot{display:table-footer-group}
  tr{break-inside:avoid}
  .col-empty{display:none!important}
}
