<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>مكتبة الأصناف</title>

  <!-- Light theme CSS -->
  <link rel="stylesheet" href="css/food-items.css" />

  <!-- SheetJS (Excel) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- نلغي الـ favicon المكسور -->
  <link rel="icon" href="data:,">
</head>
<body>
  <!-- Topbar -->
  <div class="topbar">
    <div class="row gap-8">
      <button id="addBtn" class="btn primary">إضافة صنف</button>
      <button id="refreshBtn" class="btn">تحديث</button>
      <button id="exportBtn" class="btn">تصدير إلى Excel</button>
      <label class="file-btn">
        <input id="importFile" type="file" accept=".xlsx,.xls" hidden />
        <span class="btn">استيراد من Excel</span>
      </label>
    </div>

    <div class="row gap-12">
      <span class="admin" id="adminName">—</span>
      <button id="logoutBtn" class="btn danger sm">خروج</button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters">
    <label class="chk">
      <input id="onlyActive" type="checkbox" checked />
      <span>نشط فقط</span>
    </label>

    <select id="catSelect" class="input w160">
      <option value="">(الكل)</option>
      <option value="نشويات">نشويات</option>
      <option value="منتجات الحليب">منتجات الحليب</option>
      <option value="الفاكهة">الفاكهة</option>
      <option value="الخضروات">الخضروات</option>
      <option value="منتجات اللحوم">منتجات اللحوم</option>
      <option value="الدهون">الدهون</option>
      <option value="الحلويات">الحلويات</option>
      <option value="أخرى">أخرى</option>
    </select>

    <input id="searchBox" class="input grow" placeholder="بحث بالاسم/الوصف/الوسم" />
  </div>

  <!-- Cards -->
  <div id="cards" class="cards"></div>

  <!-- Dialog (Add/Edit) -->
  <dialog id="itemDialog" class="modal">
    <form method="dialog" class="panel" id="itemForm">
      <div class="modal-head">
        <strong>بيانات الصنف</strong>
        <button type="button" class="icon" id="closeDlg">✕</button>
      </div>

      <div class="grid-3">
        <div class="col">
          <label>الاسم (AR)</label>
          <input class="input" id="nameAr" required />
        </div>
        <div class="col">
          <label>الوصف (AR)</label>
          <input class="input" id="descAr" placeholder="اختياري" />
        </div>
        <div class="col">
          <label>الصورة (رابط)</label>
          <input class="input" id="imageUrl" placeholder="https://..." />
        </div>

        <div class="col">
          <label>الفئة</label>
          <input class="input" id="category" list="catsList" placeholder="اكتب أو اختر" />
          <datalist id="catsList">
            <option>نشويات</option>
            <option>منتجات الحليب</option>
            <option>الفاكهة</option>
            <option>الخضروات</option>
            <option>منتجات اللحوم</option>
            <option>الدهون</option>
            <option>الحلويات</option>
            <option>أخرى</option>
          </datalist>
        </div>
        <div class="col">
          <label>GI</label>
          <input class="input" id="gi" type="number" min="0" />
        </div>
        <div class="col">
          <label>نشط؟</label>
          <div class="row"><input id="isActive" type="checkbox" checked /></div>
        </div>
      </div>

      <div class="group-title mt-12">القيم الغذائية لكل 100g</div>
      <div class="grid-3">
        <div class="col"><label>السعرات</label><input class="input" id="cal" type="number" min="0" /></div>
        <div class="col"><label>الكارب (g)</label><input class="input" id="carb" type="number" step="0.1" min="0" /></div>
        <div class="col"><label>البروتين (g)</label><input class="input" id="prot" type="number" step="0.1" min="0" /></div>
        <div class="col"><label>الدهون (g)</label><input class="input" id="fat" type="number" step="0.1" min="0" /></div>
        <div class="col"><label>الألياف (g)</label><input class="input" id="fiber" type="number" step="0.1" min="0" /></div>
        <div class="col"><label>الصوديوم (mg)</label><input class="input" id="sodium" type="number" min="0" /></div>
      </div>

      <div class="group-title mt-12">مقاس الحصة</div>
      <div class="grid-3">
        <div class="col"><label>اسم الحصة</label><input class="input" id="measureName" placeholder="رغيف, كوب..." /></div>
        <div class="col"><label>جرام</label><input class="input" id="measureGrams" type="number" step="0.1" min="0" /></div>
        <div class="col"><small class="muted">يمكن إضافة/تعديل لاحقًا</small></div>
      </div>

      <div class="group-title mt-12">وسوم</div>
      <input id="tagsInput" class="input" placeholder="اكتب وسم ثم Enter، مثال: فطور#، بروتين#" />

      <div class="group-title mt-12">اقتراح الأنظمة (تلقائي)</div>
      <div id="dietChips" class="chips"></div>
      <div class="chips sug" id="autoChips"></div>
      <small class="muted">نحدد تلقائيًا حسب القيم، وتقدر تضيف/تشيل.</small>

      <div class="footer">
        <button type="button" class="btn danger" id="deleteBtn" hidden>حذف</button>
        <button class="btn" value="cancel">إلغاء</button>
        <button class="btn primary" id="saveBtn">حفظ</button>
      </div>
    </form>
  </dialog>

  <!-- JS -->
  <script type="module" src="js/food-items.js"></script>
</body>
</html>
