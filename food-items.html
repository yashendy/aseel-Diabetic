<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>مكتبة الأصناف</title>
  <link rel="stylesheet" href="css/food-items.css?v=3" />

  <!-- SheetJS (لازم قبل ملف الموديول) -->
  <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <!-- ملف الجافاسكربت (موديول) -->
  <script type="module" src="js/food-items.js?v=3"></script>
</head>
<body>
  <header class="topbar">
    <div class="left">
      <button id="btnLogout" class="btn ghost">خروج</button>
      <span class="pill user" id="adminName">—</span>
    </div>

    <h1 class="title">مكتبة الأصناف</h1>

    <div class="right row gap-6">
      <button id="btnAdd" class="btn primary">إضافة صنف</button>
      <button id="btnRefresh" class="btn">تحديث</button>

      <input id="excelImportInput" type="file" accept=".xlsx,.xls" hidden />
      <button id="btnImportExcel" class="btn">استيراد من Excel</button>
      <button id="btnExportExcel" class="btn">تصدير إلى Excel</button>
    </div>
  </header>

  <section class="filters row gap-8">
    <input id="txtSearch" class="input grow" placeholder="بحث بالاسم/الوصف/الوسم" />
    <select id="selCategory" class="input">
      <option value="">(الكل)</option>
      <option>النشويات</option>
      <option>منتجات الحليب</option>
      <option>الفاكهة</option>
      <option>الخضروات</option>
      <option>منتجات اللحوم</option>
      <option>الدهون</option>
      <option>الحلويات</option>
      <option>أخرى</option>
    </select>
    <label class="row gap-3">
      <input id="chkActiveOnly" type="checkbox" checked />
      <span>نشط فقط</span>
    </label>
  </section>

  <main id="itemsGrid" class="grid"></main>

  <!-- نافذة نموذج الإضافة/التعديل -->
  <div id="formModal" class="modal hidden">
    <div class="modal-card">
      <h3 id="formTitle">إضافة صنف</h3>

      <div class="form grid-2 gap-10">
        <div class="col">
          <label>الاسم (AR)</label>
          <input id="f_nameAR" class="input" placeholder="مثال: أرز مسلوق" />

          <label>الفئة</label>
          <select id="f_category" class="input">
            <option>النشويات</option>
            <option>منتجات الحليب</option>
            <option>الفاكهة</option>
            <option>الخضروات</option>
            <option>منتجات اللحوم</option>
            <option>الدهون</option>
            <option>الحلويات</option>
            <option>أخرى</option>
          </select>

          <label>رابط صورة</label>
          <input id="f_imageUrl" class="input" placeholder="https://..." />

          <label>GI</label>
          <input id="f_gi" class="input" placeholder="مثال: 73" />
        </div>

        <div class="col">
          <p class="muted">القيم الغذائية لكل 100g</p>

          <label>السعرات (kcal)</label>
          <input id="n_cal" class="input" placeholder="0" />

          <label>الكارب (g)</label>
          <input id="n_carb" class="input" placeholder="0" />

          <label>الدهون (g)</label>
          <input id="n_fat" class="input" placeholder="0" />

          <label>البروتين (g)</label>
          <input id="n_protein" class="input" placeholder="0" />

          <label>الصوديوم (mg)</label>
          <input id="n_sodium" class="input" placeholder="0" />

          <label>الألياف (g)</label>
          <input id="n_fiber" class="input" placeholder="0" />
        </div>
      </div>

      <div class="row gap-6 mt-8">
        <label class="row gap-3"><input id="f_active" type="checkbox" checked /><span>نشط</span></label>
        <div class="grow"></div>
        <button id="btnPreview" class="btn primary">معاينة</button>
        <button id="btnCancelForm" class="btn">إلغاء</button>
      </div>
    </div>
  </div>

  <!-- نافذة المعاينة -->
  <div id="previewModal" class="modal hidden">
    <div class="modal-card">
      <h3>معاينة الصنف</h3>
      <div id="previewBody" class="space-y"></div>
      <div class="row gap-6 mt-8">
        <button id="btnConfirmSave" class="btn primary">تأكيد الحفظ</button>
        <button id="btnCancelPreview" class="btn">إلغاء</button>
      </div>
    </div>
  </div>

  <!-- نافذة تأكيد الحذف -->
  <div id="confirmModal" class="modal hidden">
    <div class="modal-card">
      <h3>تأكيد الحذف</h3>
      <p>هل أنت متأكد من حذف هذا الصنف؟ لا يمكن التراجع.</p>
      <div class="row gap-6 mt-8">
        <button id="btnDoDelete" class="btn danger">حذف</button>
        <button id="btnCancelDelete" class="btn">إلغاء</button>
      </div>
    </div>
  </div>
</body>
</html>
