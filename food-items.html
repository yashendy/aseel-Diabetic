<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>الأصناف | لوحة الإدارة</title>

  <!-- خط عربي موحّد -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">

  <!-- ستايل واحد موحّد (مُدمَج: الأساسي + الثيم) -->
  <link rel="stylesheet" href="./css/food-items.css">
</head>
<body>
  <!-- الهيدر: اسم الأدمن + دخول/خروج + استيراد/تصدير -->
  <header class="topbar">
    <div class="brand">مكتبة الأصناف</div>
    <div class="admin">
      <span id="admin-name"></span> · <span id="admin-role"></span>
      <button id="btn-auth" class="btn primary">تسجيل الدخول</button>
      <button id="btn-logout" class="btn" style="display:none">تسجيل الخروج</button>
      <button id="btn-export" class="btn">تصدير</button>
      <button id="btn-import" class="btn">استيراد</button>
      <input id="import-file" type="file" accept=".json,.csv" style="display:none">
    </div>
  </header>

  <!-- فلاتر -->
  <section class="filters-card">
    <div class="filters-row">
      <input id="search" type="search" placeholder="بحث بالاسم أو الوسوم...">
      <select id="filter-category">
        <option value="">كل الفئات</option>
        <option>النشويات</option>
        <option>منتجات الألبان</option>
        <option>الفاكهة</option>
        <option>الخضروات</option>
        <option>منتجات اللحوم</option>
        <option>الدهون</option>
        <option>الحلويات</option>
        <option>أخرى</option>
      </select>
      <label class="chk"><input id="filter-active" type="checkbox" checked> فعّال فقط</label>
      <button id="btn-clear" class="btn">مسح</button>
      <span class="spacer"></span>
      <button id="btn-cards" class="btn toggle active">بطاقات</button>
      <button id="btn-table" class="btn toggle">جدول</button>
      <button id="btn-add" class="btn primary">+ إضافة صنف</button>
    </div>
  </section>

  <!-- المحتوى -->
  <main class="content">
    <div id="cards" class="cards"></div>

    <div id="table-wrap" class="table-wrap" style="display:none">
      <table class="table">
        <thead>
          <tr>
            <th>الاسم</th><th>الفئة</th><th>سعرات</th><th>كارب</th><th>بروتين</th><th>دهون</th><th>نشط؟</th><th></th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>
    </div>

    <div class="pager">
      <button id="prev" class="btn">&larr; السابق</button>
      <span id="page-label">صفحة 1</span>
      <button id="next" class="btn">التالي &rarr;</button>
    </div>
  </main>

  <!-- نافذة الإضافة/التعديل -->
  <dialog id="edit-dialog" class="dialog">
    <div class="dialog-header">
      <strong id="dlg-title">إضافة/تعديل صنف</strong>
      <button id="dlg-close" class="btn">×</button>
    </div>
    <form id="edit-form" class="dialog-content">
      <input type="hidden" id="item-id">
      <div class="form-grid-2">
        <div class="form-group"><label>الاسم</label><input id="name" type="text" required></div>
        <div class="form-group"><label>الفئة</label>
          <select id="category" required>
            <option></option>
            <option>النشويات</option><option>منتجات الألبان</option><option>الفاكهة</option>
            <option>الخضروات</option><option>منتجات اللحوم</option><option>الدهون</option>
            <option>الحلويات</option><option>أخرى</option>
          </select>
        </div>
        <div class="form-group"><label>سعرات (kcal/100g)</label><input id="cal_kcal" type="number" step="0.1"></div>
        <div class="form-group"><label>كربوهيدرات (g)</label><input id="carbs_g" type="number" step="0.1"></div>
        <div class="form-group"><label>بروتين (g)</label><input id="protein_g" type="number" step="0.1"></div>
        <div class="form-group"><label>دهون (g)</label><input id="fat_g" type="number" step="0.1"></div>
        <div class="form-group"><label>فعّال؟</label>
          <select id="isActive"><option value="true" selected>نعم</option><option value="false">لا</option></select>
        </div>
        <div class="form-group"><label>وسوم البحث</label>
          <input id="searchTags" type="text" placeholder="مثال: #سكري #قليل_الدهون">
          <small class="hint">تساعد في البحث.</small>
        </div>
      </div>

      <div class="image-uploader">
        <label>الصورة</label>
        <input id="imageUrl" type="url" placeholder="https://...">
        <input id="imageFile" type="file" accept="image/*">
        <img id="imagePreview" alt="" />
      </div>
    </form>
    <div class="dialog-actions">
      <button id="btn-delete" class="btn danger">حذف</button>
      <button id="btn-save" class="btn primary">حفظ</button>
    </div>
  </dialog>

  <!-- سكربتات -->
  <script type="module" src="./js/firebase-config.js"></script>
  <script type="module" src="./js/food-items.js"></script>
</body>
</html>
