<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ุชุญููู ุงูููุงุณุงุช</title>

  <!-- ุฃููููุฉ ุงููููุน (ุชุธูุฑ ูู ูู ุงูุตูุญุงุช) -->
  <link rel="icon" href="favicon.ico" />

  <!-- ุณุชุงูู ุงูุตูุญุฉ -->
  <link rel="stylesheet" href="css/analytics.css?v=10" />

  <!-- Chart.js + date-fns adapter (ููู ุฌุฏูุง ูููุญูุฑ ุงูุฒููู) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

  <!-- ููุงุญุธุฉ: ูุง ูุญููู date-fns ูู <script> ุนุงุฏูุ ุณูุณุชูุฑุฏูุง ูู ููู ุงูู JS ูู ESM -->
</head>
<body>
  <div class="container">

    <header class="top card">
      <div class="row header-row">
        <button id="backBtn" class="btn icon">โฉ๏ธ ุฑุฌูุน</button>
        <h1>ุชุญููู ุงูููุงุณุงุช โ <span id="childName">โ</span> <span class="icon">๐</span></h1>
      </div>

      <div id="childMeta" class="muted tiny">โ</div>

      <div class="filters">
        <div class="row gap">
          <div class="field">
            <label>ุงููุญุฏุฉ</label>
            <select id="unitSel">
              <option value="mmol">mmol/L</option>
              <option value="mgdl">mg/dL</option>
            </select>
          </div>

          <div class="field">
            <label>ูู</label>
            <input type="date" id="dateFrom" />
          </div>

          <div class="field">
            <label>ุฅูู</label>
            <input type="date" id="dateTo" />
          </div>

          <div class="field">
            <label>&nbsp;</label>
            <button id="applyBtn" class="btn">ุชุทุจูู</button>
          </div>
        </div>

        <div class="row chips">
          <button class="chip range" data-r="14">ุขุฎุฑ 14 ููู</button>
          <button class="chip range" data-r="30">ุขุฎุฑ 30 ููู</button>
          <button class="chip range" data-r="90">ุขุฎุฑ 90 ููู</button>
          <span class="sep"></span>
          <button class="chip slot" data-slot="ALL">ุงููู</button>
          <button class="chip slot" data-slot="PRE_BREAKFAST">ูุจู ุงููุทูุฑ</button>
          <button class="chip slot" data-slot="POST_BREAKFAST">ุจุนุฏ ุงููุทูุฑ</button>
          <button class="chip slot" data-slot="PRE_LUNCH">ูุจู ุงูุบุฏุงุก</button>
          <button class="chip slot" data-slot="POST_LUNCH">ุจุนุฏ ุงูุบุฏุงุก</button>
          <button class="chip slot" data-slot="PRE_DINNER">ูุจู ุงูุนุดุงุก</button>
          <button class="chip slot" data-slot="POST_DINNER">ุจุนุฏ ุงูุนุดุงุก</button>
          <button class="chip slot" data-slot="SNACK">ุณูุงู</button>
          <button class="chip slot" data-slot="SLEEP">ุงูููู</button>
        </div>

        <div class="row tools">
          <button id="btnPdf" class="btn light">๐จ๏ธ ุทุจุงุนุฉ / PDF</button>
          <button id="btnCsv" class="btn light">๐งพ ุชูุฒูู CSV</button>
          <button id="aiBtn" class="btn light">๐ค ูุณุงุนุฏ ุงูุชุญููู</button>
        </div>
      </div>
    </header>

    <!-- ุจุทุงูุงุช ุงููุคุดุฑุงุช -->
    <section class="cards">
      <div class="card stat"><div class="label">ุนุฏุฏ ุงูููุงุณุงุช</div><div id="kCnt" class="value">โ</div></div>
      <div class="card stat"><div class="label">ุงููุชูุณุท</div><div id="kAvg" class="value">โ</div></div>
      <div class="card stat"><div class="label">ุงูุงูุญุฑุงู ุงููุนูุงุฑู</div><div id="kSd" class="value">โ</div></div>
      <div class="card stat"><div class="label">ููุช ุฏุงุฎู ุงููุทุงู (TIR)</div><div id="kTir" class="value">โ</div></div>
      <div class="card stat"><div class="label">ุงุฑุชูุงุนุงุช</div><div id="kHigh" class="value">โ</div></div>
      <div class="card stat"><div class="label">ูุจูุทุงุช</div><div id="kLow" class="value">โ</div></div>
    </section>

    <!-- ุฑุณู: ูุชูุณุท/ุงุฑุชูุงุน/ูุจูุท -->
    <section class="card">
      <div class="table-head">
        <h3>ููุญูู ุงูุฌููููุฒ ูุน ุงูุฒูู</h3>
      </div>
      <canvas id="mainChart" height="110"></canvas>
    </section>

    <!-- ููุงุฑูุฉ ุฃุณุจูุน ุจุฃุณุจูุน ุณุงุจู -->
    <section class="card">
      <div class="table-head">
        <h3>ููุงุฑูุฉ ุฃุณุจูุน ุจุงูุฃุณุจูุน ุงูุณุงุจู</h3>
      </div>
      <canvas id="cmpChart" height="80"></canvas>
    </section>

    <!-- ุชูุจูู -->
    <p class="note muted tiny">ูุฐุง ุงูุชุญููู ููุชูุนูุฉ ููุท ูููุณ ุจุฏููุงู ุนู ุงุณุชุดุงุฑุฉ ุงูุทุจูุจ.</p>
  </div>

  <!-- Firebase config (ูุณุฎุฉ v12 modular ููุง ุชุณุชุฎุฏููููุง) -->
  <script type="module" src="js/analytics.js?v=10"></script>
</body>
</html>
