<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>إعدادات الطفل</title>
  <link rel="stylesheet" href="./css/child-edit.css" />
  <style>
    :root{--bg:#0c1024;--panel:#111736;--text:#ebefff;--muted:#9fb0d2;--border:#1f2b5b;--good:#22c55e;--danger:#ef4444;--primary:#4f76ff}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b1020,#0e1430);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Noto Sans Arabic",Tahoma,sans-serif}
    .wrap{max-width:960px;margin-inline:auto;padding:24px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    .title{font-weight:900;font-size:clamp(20px,3.4vw,30px)}
    .card{background:rgba(17,23,54,.7);border:1px solid var(--border);border-radius:16px;padding:14px;margin-bottom:14px;backdrop-filter:blur(6px)}
    .section-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .grid{display:grid;gap:10px}
    .grid-2{grid-template-columns:1fr 1fr}
    .field label{display:block;font-size:12px;color:var(--muted);margin:0 0 6px 0}
    .field input{width:100%;height:44px;border-radius:10px;background:#0f1531;color:#e8edfb;border:1px solid var(--border);padding:0 12px;outline:none}
    .btn{border:0;cursor:pointer;border-radius:12px;padding:10px 14px;font-weight:800;color:#fff;background:linear-gradient(180deg,var(--primary),#345dff)}
    .btn.secondary{background:#1b2350;border:1px solid #2a3a83}
    .btn.good{background:linear-gradient(180deg,var(--good),#16a34a)}
    .btn.danger{background:linear-gradient(180deg,var(--danger),#dc2626)}
    .inline{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .muted{color:var(--muted)}
    .badge{display:inline-block;background:#122055;border:1px solid #2642a8;padding:4px 10px;border-radius:999px;font-size:12px}
    .note{font-size:12px;color:#9fb0d2}
    .status{margin-top:8px;font-size:14px}
    .status.ok{color:#77ffb1}
    .status.err{color:#ff98a0}
    .table{overflow:auto;border:1px solid var(--border);border-radius:12px}
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px solid var(--border);padding:10px;text-align:right}
    th{color:#bfd0ff;background:#121c48}
  </style>
</head>
<body>
  <div class="wrap" id="childEditPage">
    <header>
      <h1 class="title">إعدادات الطفل</h1>
      <div class="inline">
        <button id="btnRefresh" class="btn secondary" type="button">تحديث</button>
      </div>
    </header>

    <!-- معلومات أساسية -->
    <section class="card">
      <div class="section-head">
        <h2>بيانات الطفل</h2>
        <span id="childIdBadge" class="badge">—</span>
      </div>

      <div class="table">
        <table>
          <tbody id="infoTbody">
            <tr><td class="muted">الاسم</td><td id="cName">—</td></tr>
            <tr><td class="muted">الجنس</td><td id="cGender">—</td></tr>
            <tr><td class="muted">تاريخ الميلاد</td><td id="cBirth">—</td></tr>
            <tr><td class="muted">وحدة الجلوكوز</td><td id="cUnit">—</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ربط الطفل بالدكتور -->
    <section class="card">
      <div class="section-head">
        <h2>ربط الطفل بطبيب عبر كود</h2>
        <span id="doctorState" class="badge">غير مرتبط</span>
      </div>

      <div class="grid grid-2">
        <div class="field">
          <label>الكود</label>
          <input id="codeInput" placeholder="أدخل كود الربط هنا" />
        </div>
        <div class="inline" style="align-items:flex-end">
          <button id="btnLink" class="btn good" type="button">ربط مع دكتور</button>
          <button id="btnUnlink" class="btn danger" type="button" title="إلغاء الربط الحالي">إلغاء الربط</button>
        </div>
      </div>
      <p class="note">الربط يفعّل مشاركة البيانات مع الطبيب المرتبط. الكود يُستخدم لطفل واحد فقط.</p>
      <div id="linkStatus" class="status"></div>
    </section>
  </div>

  <script type="module" src="./js/child-edit.js"></script>
</body>
</html>
