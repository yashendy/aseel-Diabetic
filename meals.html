<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>وجبة اليوم — الكاربات + GI/GL</title>
  <link rel="stylesheet" href="meals.css" />
  <!-- Firebase SDKs (لو عندك firebase-config.js يتهيأ فيها) -->
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore-compat.js"></script>

  <!-- تهيئة مشروعك -->
  <script defer src="firebase-config.js"></script>
  <script defer src="meals.js"></script>
</head>
<body>
  <header class="topbar">
    <h1>تسجيل وجبة</h1>
    <div class="ctx">
      <label>الطفل:
        <select id="childSelect"></select>
      </label>
      <label>التاريخ:
        <input id="dateInput" type="date" />
      </label>
      <label>وقت القياس:
        <select id="mealSlot">
          <option value="PRE_BREAKFAST">ق.الفطار</option>
          <option value="PRE_LUNCH">ق.الغدا</option>
          <option value="PRE_DINNER">ق.العشا</option>
          <option value="POST_BREAKFAST">ب.الفطار</option>
          <option value="POST_LUNCH">ب.الغدا</option>
          <option value="POST_DINNER">ب.العشا</option>
          <option value="SNACK">السناك</option>
        </select>
      </label>
    </div>
    <div class="meas">
      <label>قياس قبل:
        <input id="preReading" type="number" step="0.1" placeholder="mmol/L" />
      </label>
      <label>قياس بعد:
        <input id="postReading" type="number" step="0.1" placeholder="mmol/L" />
      </label>
      <button id="reloadMeasures" class="ghost">جلب قياسات اليوم</button>
    </div>
  </header>

  <main class="card">
    <div class="tableHead">
      <div>الصنف</div>
      <div>وحدة</div>
      <div>جم/الوحدة</div>
      <div>الكمية</div>
      <div>الجرامات</div>
      <div>كارب/100جم</div>
      <div>الكارب</div>
      <div>GI</div>
      <div>GL</div>
      <div>سعرات</div>
      <div>بروتين</div>
      <div>دهون</div>
      <div>إجراء</div>
    </div>
    <div id="rows" class="rows"></div>

    <button id="addRow" class="primary">+ إضافة صنف</button>

    <section class="summary">
      <div><strong>إجمالي الكارب:</strong> <span id="sumCarbs">0</span> جم</div>
      <div><strong>إجمالي GL:</strong> <span id="sumGL">0</span></div>
      <div><strong>متوسط GI (مرجّح بالكارب):</strong> <span id="avgGI">—</span></div>
    </section>

    <footer class="actions">
      <button id="saveMeal" class="success">حفظ الوجبة</button>
      <span id="saveStatus" class="muted"></span>
    </footer>
  </main>
</body>
</html>
