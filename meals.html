<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุฅุฏุงุฑุฉ ุงููุฌุจุงุช</title>
  <link rel="stylesheet" href="./css/meals.css" />
</head>
<body>

<header class="topbar">
  <div class="brand">ุฅุฏุงุฑุฉ ุงููุฌุจุงุช</div>
  <a class="btn ghost" href="./child.html" id="backBtn">ุงูุทูู</a>
</header>

<main class="container">

  <!-- ููุญุฉ ุงูููุฎุต -->
  <section class="summary">
    <div class="card">
      <div class="title">ูุฑุงุกุฉ ุงูุณูุฑ ุงูุญุงููุฉ</div>
      <div class="value"><input id="glucoseNow" type="number" step="0.1" placeholder="110 ุฃู 6.2" /></div>
      <div class="hint" id="glucoseUnit">mmol/L</div>
    </div>

    <div class="card">
      <div class="title">ูุฏู ุงูุชุตุญูุญ</div>
      <div class="value" id="targetText">โ</div>
      <div class="hint">ูู ุฅุนุฏุงุฏุงุช ุงูุทูู</div>
    </div>

    <div class="card">
      <div class="title">CR (ูุนุงุฏู ุงููุงุฑุจ)</div>
      <div class="value" id="crText">โ</div>
      <div class="hint" id="crSource">ุนุงู/ุญุณุจ ุงููุฌุจุฉ</div>
    </div>

    <div class="card">
      <div class="title">CF/ISF (ูุนุงูู ุงูุชุตุญูุญ)</div>
      <div class="value" id="cfText">โ</div>
      <div class="hint">ุนุงู/ุญุณุจ ุงููุฌุจุฉ</div>
    </div>
  </section>

  <!-- ููุน ุงููุฌุจุฉ + ูุงุฑุจ ุงููุฌุจุฉ -->
  <section class="bar">
    <div class="group">
      <label>ููุน ุงููุฌุจุฉ</label>
      <select id="mealType">
        <option value="breakfast">ูุทุงุฑ</option>
        <option value="lunch">ุบุฏุง</option>
        <option value="dinner">ุนุดุง</option>
        <option value="snack">ุณูุงู</option>
      </select>
    </div>

    <div class="group">
      <label>ูุงุฑุจ ุงููุฌุจุฉ (ุฌุฑุงู)</label>
      <input id="carbsTotal" type="number" step="0.1" placeholder="ููุญุชุณุจ ุชููุงุฆููุง" readonly />
      <div class="hint">ูู ุฃุถูุชู ุงูุญุตุต/ุฌุฑุงู/ูุญุฏุฉุ ูุชุญุณุจ ุชููุงุฆููุง.</div>
    </div>

    <div class="group target-pill">
      <div id="rangeText">โ</div>
      <span id="rangeBadge" class="badge">โ</span>
      <button id="btnEditRange" class="btn ghost sm">ุชุนุฏูู ุงููุทุงู</button>
    </div>
  </section>

  <!-- ุฃุฒุฑุงุฑ ุนุงูุฉ -->
  <section class="actions">
    <button id="btnOpenLib" class="btn">ุฅุถุงูุฉ ุตูู ูู ุงูููุชุจุฉ</button>
    <button id="btnAutoFit" class="btn warn">ุชุนุฏูู ุงูููุงุฏูุฑ (0.25)</button>
    <button id="btnSuggest" class="btn ghost">ุงูุชุฑุงุญ ุจุฏุงุฆู ๐ค</button>

    <div class="spacer"></div>

    <button id="btnSavePreset" class="btn ghost">ุญูุธ ููุฌุจุฉ ุฌุงูุฒุฉ ๐๏ธ</button>
    <button id="btnLoadPreset" class="btn ghost">ุชุญููู ูุฌุจุฉ ุฌุงูุฒุฉ</button>
  </section>

  <!-- ุฌุฏูู ุงูุณูุฉ -->
  <section class="basket">
    <h3>ุงูุฃุตูุงู ุงููุฎุชุงุฑุฉ ูููุฌุจุฉ</h3>
    <div class="table-wrap">
      <table class="tbl">
        <thead>
          <tr>
            <th>ุงูุตูู</th>
            <th>ุงููููุฉ (ูุญุฏุงุช)</th>
            <th>ุฌุฑุงู/ูุญุฏุฉ</th>
            <th>ุงููุงุฑุจ (ุฌู)</th>
            <th>ุญุฐู</th>
          </tr>
        </thead>
        <tbody id="basketBody">
          <tr class="empty"><td colspan="5">ูุง ุชูุฌุฏ ุฃุตูุงู ุจุนุฏ</td></tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="3" class="total-label">ุฅุฌูุงูู ุงููุงุฑุจ</td>
            <td id="basketTotal">0.0</td>
            <td></td>
          </tr>
        </tfoot>
      </table>
    </div>
    <div class="status-line">
      <span id="fitHint"></span>
    </div>
  </section>

  <!-- ุงูุฌุฑุนุงุช -->
  <section class="doses">
    <div class="card big">
      <div class="title">ุฌุฑุนุฉ ุงููุงุฑุจ</div>
      <div class="value" id="doseCarb">0.00</div>
      <div class="hint">Carbs รท CR</div>
    </div>
    <div class="card big">
      <div class="title">ุฌุฑุนุฉ ุงูุชุตุญูุญ</div>
      <div class="value" id="doseCorr">0.00</div>
      <div class="hint">(glucoseNow โ target) รท CF</div>
    </div>
    <div class="card big">
      <div class="title">ุฅุฌูุงูู ุงูุฌุฑุนุฉ</div>
      <div class="value" id="doseTotal">0.00</div>
      <div class="hint">ุฃููุฑุจ ูุฃูุฑุจ 0.05</div>
    </div>
  </section>

</main>

<!-- ูุงูุฐุฉ ุงูููุชุจุฉ -->
<div class="modal" id="libModal" hidden>
  <div class="overlay" data-close="#libModal"></div>
  <div class="sheet">
    <div class="sheet-head">
      <h4>ุงูููุชุจุฉ</h4>
      <button class="btn ghost" data-close="#libModal">ุฅุบูุงู</button>
    </div>
    <div class="lib-list" id="libList"></div>
  </div>
</div>

<!-- ูุงูุฐุฉ ุชุนุฏูู ุงููุทุงู -->
<div class="modal" id="rangeModal" hidden>
  <div class="overlay" data-close="#rangeModal"></div>
  <div class="sheet">
    <div class="sheet-head">
      <h4>ุชุนุฏูู ุงููุทุงู (ูุฐู ุงููุฌุจุฉ ููุท)</h4>
      <button class="btn ghost" data-close="#rangeModal">ุฅุบูุงู</button>
    </div>
    <div class="form-rows">
      <div class="row">
        <label>ุงูุญุฏ ุงูุฃุฏูู (ุฌู)</label>
        <input type="number" step="0.1" id="rangeMinInput" />
      </div>
      <div class="row">
        <label>ุงูุญุฏ ุงูุฃุนูู (ุฌู)</label>
        <input type="number" step="0.1" id="rangeMaxInput" />
      </div>
      <div class="row">
        <button id="rangeSave" class="btn">ุญูุธ</button>
      </div>
      <small class="muted">ูู ูุบููุฑ ูุฐุง ุฅุนุฏุงุฏุงุช ุงูุทูู โ ููุท ููุฐู ุงููุฌุจุฉ.</small>
    </div>
  </div>
</div>

<script src="./js/meals.js"></script>
<!-- (ุงุฎุชูุงุฑู) ููู ุงูุฐูุงุก ุงูุตูุงุนู ุฅู ูุฌุฏ -->
<script src="./js/ai.js" defer></script>
</body>
</html>
