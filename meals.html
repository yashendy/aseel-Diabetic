<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุงููุฌุจุงุช</title>
  <link rel="stylesheet" href="css/meals.css?v=6" />
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
</head>
<body>
  <div class="container">
    <div id="toast" class="toast hidden"><div class="msg"></div></div>

    <!-- ุฑุฃุณ -->
    <div class="row between center mb-12">
      <div class="row center gap-8">
        <button id="backBtn" class="secondary">ุฑุฌูุน</button>
        <h2 class="row center gap-8">ูุฌุจุงุช ุฌุงูุฒุฉ <span class="emoji">๐ง</span></h2>
      </div>
      <div class="row center gap-8">
        <button id="saveDraftBtn" class="primary">ุญูุธ ููุณูุฏุฉ</button>
      </div>
    </div>

    <!-- ุจูุงูุงุช ุงูุทูู -->
    <div class="card">
      <div class="row wrap gap-12">
        <div>
          <div class="muted tiny">ุงูุทูู</div>
          <div id="childName" class="b"></div>
          <div id="childMeta" class="muted tiny"></div>
        </div>
        <div class="grow"></div>
        <div>
          <div class="muted tiny">ุงูุชุงุฑูุฎ</div>
          <input id="mealDate" type="date" />
        </div>
        <div>
          <div class="muted tiny">ููุน ุงููุฌุจุฉ</div>
          <select id="mealType">
            <option value="breakfast">ูุทูุฑ</option>
            <option value="lunch">ุบุฏุงุก</option>
            <option value="dinner">ุนุดุงุก</option>
            <option value="snack">ุณูุงู</option>
          </select>
        </div>
      </div>

      <div class="row gap-12 mt-12 wrap">
        <div>
          <div class="muted tiny">ุงููุฑุงุกุฉ ูุจู</div>
          <input id="preReading" type="number" step="0.1" />
        </div>
        <div>
          <div class="muted tiny">ุงููุฑุงุกุฉ ุจุนุฏ</div>
          <input id="postReading" type="number" step="0.1" />
        </div>
      </div>
    </div>

    <!-- ูููููุงุช -->
    <div class="card">
      <div class="row between center">
        <h3>ูููููุงุช ุงููุฌุจุฉ</h3>
        <div class="row gap-8">
          <button id="addItemBtn" class="primary">ุฅุถุงูุฉ ููููู</button>
          <button id="repeatLastBtn" class="secondary">ุชูุฑุงุฑ ุขุฎุฑ ูุฌุจุฉ</button>
          <button id="smartAdjustBtn" class="primary">ุถุจุท ุงููุฏู</button>
        </div>
      </div>

      <div class="table mt-12">
        <div class="thead">
          <div>ุญุฐู</div><div>ุฏููู</div><div>ุจุฑูุชูู</div><div>ุณุนุฑุงุช</div>
          <div>ูุงุฑุจ</div><div>ุงูุฌุฑุงูุงุช</div><div>ุงููููุงุณ</div>
          <div>ุงููููุฉ</div><div>ุงููุญุฏุฉ</div><div>ุงูุตูู</div>
        </div>
        <div id="itemsBody" class="tbody"></div>
      </div>

      <div class="sum-grid mt-12">
        <div class="cells"><div class="muted tiny">ุงูุฏููู</div><div id="tFat" class="b">0</div></div>
        <div class="cells"><div class="muted tiny">ุงูุจุฑูุชูู</div><div id="tProt" class="b">0</div></div>
        <div class="cells"><div class="muted tiny">ุงูุณุนุฑุงุช</div><div id="tCal" class="b">0</div></div>
        <div class="cells"><div class="muted tiny">ุงููุงุฑุจ</div><div id="tCarbs" class="b">0</div></div>
        <div class="cells"><div class="muted tiny">ุงูุฌุฑุงูุงุช</div><div id="tGrams" class="b">0</div></div>
      </div>

      <div class="mt-12">
        <div class="muted tiny">ููุงุญุธุงุช</div>
        <textarea id="mealNotes" rows="2"></textarea>
      </div>
    </div>

    <!-- ูุงูุฐุฉ ุถุจุท -->
    <div class="modal hidden" id="adjustModal">
      <div class="modal-card">
        <div class="row between center">
          <h3>ุถุจุท ูุฏู ุงููุงุฑุจ</h3>
          <button id="closeAdjust" class="icon-btn">โ</button>
        </div>
        <div id="suggestedTarget" class="muted tiny"></div>
        <div id="adjustDiff" class="mt-12"></div>
        <div class="row gap-8 mt-12">
          <button id="applyAdjustBtn" class="primary">ุชุทุจูู</button>
          <button id="cancelAdjustBtn" class="secondary">ุฅูุบุงุก</button>
        </div>
      </div>
    </div>
  </div>

  <!-- AI Widget -->
  <div class="ai-widget hidden" id="aiWidget">
    <div class="ai-header">
      <strong>ูุญุงุฏุซุฉ ุฐููุฉ</strong>
      <button class="icon-btn" id="aiClose">โ</button>
    </div>
    <div class="ai-body"><div id="aiMessages" class="msgs"></div></div>
    <div class="ai-footer">
      <input id="aiInput" type="text" placeholder="ุณุคุงูู..." />
      <button id="aiSend" class="primary">ุฅุฑุณุงู</button>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <!-- Gemini -->
  <script>
    window.GEMINI_API_KEY = "AIzaSyBJOzP2znhOTBeVDdLn7XwMs_KtYn_tMV4";
  </script>
  <script type="module">
    if (window.GEMINI_API_KEY) {
      const { GoogleGenerativeAI } = await import("https://esm.run/@google/generative-ai");
      window.GoogleGenerativeAI = GoogleGenerativeAI;
    }
  </script>

  <!-- Script -->
  <script src="js/meals.js?v=6"></script>
</body>
</html>
