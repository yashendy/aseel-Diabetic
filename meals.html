<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุฅุฏุงุฑุฉ ุงููุฌุจุงุช</title>

  <!-- ุฃููููุฉ -->
  <link rel="icon" href="./favicon.ico">
  <!-- ุฎุทูุท ุจุณูุทุฉ -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- ุณุชุงูู ุงูุตูุญุฉ -->
  <link rel="stylesheet" href="./css/meals.css">
</head>
<body>

  <!-- ููุฏุฑ ุงูุทูู -->
  <header class="page-header">
    <div class="header-left">
      <a class="btn ghost" id="backToChild" href="./child.html">ุงูุทูู</a>
      <h1>ุฅุฏุงุฑุฉ ุงููุฌุจุงุช</h1>
    </div>
    <div class="kid-glance" id="kidGlance">
      <!-- ููุชูุฆ ุฏููุงููููุงู -->
      <div class="glance-pill"><span>ุงูุงุณู</span><strong id="kidName">โ</strong></div>
      <div class="glance-pill"><span>CR</span><strong id="kidCR">โ</strong></div>
      <div class="glance-pill"><span>CF</span><strong id="kidCF">โ</strong></div>
      <div class="glance-pill"><span>ูุฏู ุงูููุงุณ</span><strong id="kidTarget">3.5โ7</strong> <small>mmol/L</small></div>
    </div>
  </header>

  <!-- ุตู ุงูุจุทุงูุงุช ุงููุฑุฌุนูุฉ -->
  <section class="ref-cards">
    <div class="ref-card">
      <div class="ref-title">ูุฑุงุกุฉ ุงูุณูุฑ ุงูุญุงููุฉ</div>
      <div class="ref-value"><input id="glucoseNow" type="number" step="0.1" placeholder="โ"></div>
      <div class="ref-sub">mmol/L</div>
    </div>

    <div class="ref-card">
      <div class="ref-title">CF/ISF</div>
      <div class="ref-value" id="cfValue">โ</div>
      <div class="ref-sub">ุญุณุจ ุงููุฌุจุฉ/ุนุงู</div>
    </div>

    <div class="ref-card">
      <div class="ref-title">CR</div>
      <div class="ref-value" id="crValue">โ</div>
      <div class="ref-sub">ุญุณุจ ุงููุฌุจุฉ</div>
    </div>
  </section>

  <!-- ุฅุนุฏุงุฏุงุช ุฃุนูู ุงูุฌุฏูู -->
  <section class="meal-toolbar">
    <div class="meal-row">
      <div class="meal-type">
        <label>ููุน ุงููุฌุจุฉ</label>
        <select id="mealType">
          <option value="breakfast">ูุทุงุฑ</option>
          <option value="lunch">ุบุฏุงุก</option>
          <option value="dinner">ุนุดุงุก</option>
          <option value="snack">ุณูุงู</option>
        </select>
      </div>

      <div class="meal-target">
        <label>ูุงุฑุจ ุงููุฌุจุฉ (ุฌุฑุงู)</label>
        <input id="mealCarbGoal" type="number" step="1" placeholder="โ">
        <small>ูู ุชุฑูุชู ูุงุฑุบูุงุ ุจูุญุณุจ ุญุณุจ ุงูุญุตุต/ุฌุฑุงู/ูุญุฏุฉุ ููููู ุชุนุฏููู.</small>
      </div>
    </div>

    <!-- ุดุฑูุท ุงููุทุงู -->
    <div class="range-strip">
      <div class="range-labels">
        <span class="badge green" id="inRangeBadge">ุฏุงุฎู ุงููุทุงู</span>
        <span class="badge amber" id="nearRangeBadge">ูุฑูุจ ูู ุงูุญุฏูุฏ</span>
        <span class="badge red" id="outRangeBadge">ุฎุงุฑุฌ ุงููุทุงู</span>
      </div>
      <div class="progress">
        <div id="rangeProgress" class="progress-bar"></div>
      </div>

      <div class="actions-inline">
        <button class="btn pill" id="btnAdjust025">(0.25) ุชุนุฏูู ุงูููุงุฏูุฑ</button>
        <button class="btn ghost" id="btnAskAI">ุงูุชุฑุงุญ ุจุฏุงุฆู ๐ค</button>
        <button class="btn ghost" id="btnOpenLib">ุฅุถุงูุฉ ุตูู ูู ุงูููุชุจุฉ</button>
        <button class="btn ghost" id="btnSavePreset">ุญูุธ ููุฌุจุฉ ุฌุงูุฒุฉ ๐</button>
        <button class="btn ghost" id="btnLoadPreset">ุชุญููู ูุฌุจุฉ ุฌุงูุฒุฉ</button>
      </div>
    </div>
  </section>

  <!-- ุชูุถููุงุช ุงูุทูู -->
  <section class="filters">
    <div class="filter-group">
      <div class="filter-title">ุงูุฃูุธูุฉ ุงูุบุฐุงุฆูุฉ</div>
      <label><input type="checkbox" id="diet-halal"> ุญูุงู</label>
      <label><input type="checkbox" id="diet-veg"> ูุจุงุชู</label>
      <label><input type="checkbox" id="diet-lowcarb"> ูููู ุงููุงุฑุจ</label>
      <label><input type="checkbox" id="diet-lowfat"> ูููู ุงูุฏููู</label>
      <label><input type="checkbox" id="diet-lowsod"> ูููู ุงูุตูุฏููู</label>
    </div>
    <div class="filter-group">
      <div class="filter-title">(Enter) ุญุณุงุณูุงุช</div>
      <input type="text" id="allergiesInput" placeholder="ูุซุงู: peanut, lactose, egg">
    </div>
    <div class="filter-group">
      <div class="filter-title">(Enter) ููุถูุงุช</div>
      <input type="text" id="likesInput" placeholder="ูุซุงู: ุชูุงุญุ ุฒุจุงุฏู...">
    </div>
    <div class="filter-group">
      <div class="filter-title">(Enter) ุบูุฑ ููุถูุงุช</div>
      <input type="text" id="dislikesInput" placeholder="ูุซุงู: ุณุจุงูุฎ...">
    </div>
  </section>

  <!-- ุฌุฏูู ุงูุฃุตูุงู ุงููุฎุชุงุฑุฉ -->
  <section class="items-card">
    <div class="items-header">
      <h3>ุงูุฃุตูุงู ุงููุฎุชุงุฑุฉ ูููุฌุจุฉ</h3>
    </div>
    <div class="table">
      <div class="row head">
        <div>ุญุฐู</div>
        <div>ุงูุตูู</div>
        <div>ุงููููุฉ (ูุญุฏุงุช)</div>
        <div>ุฌุฑุงู/ูุญุฏุฉ</div>
        <div>ุงููุงุฑุจ (ุฌู)</div>
      </div>
      <div id="itemsBody"></div>
      <div class="row foot">
        <div></div><div>ุฅุฌูุงูู ุงููุงุฑุจ</div><div></div><div></div>
        <div id="totalCarbsCell">0.0</div>
      </div>
    </div>
  </section>

  <!-- ุจุทุงูุงุช ุงูุฌุฑุนุงุช -->
  <section class="dose-cards">
    <div class="dose-card">
      <div class="dose-title">ุฌุฑุนุฉ ุงูุฃูู</div>
      <div class="dose-value" id="mealDose">0.00</div>
      <div class="dose-sub">totalCarbs รท CR</div>
    </div>

    <div class="dose-card">
      <div class="dose-title">ุฌุฑุนุฉ ุงูุชุตุญูุญ</div>
      <div class="dose-value" id="corrDose">0.00</div>
      <div class="dose-sub">max(0, (glucoseNow โ target) รท CF)</div>
    </div>

    <div class="dose-card highlight">
      <div class="dose-title">ุฅุฌูุงูู ุงูุฌุฑุนุฉ</div>
      <div class="dose-value" id="totalDose">0.00</div>
      <div class="dose-sub">ุชูุฑูุจ 0.05U</div>
    </div>
  </section>

  <!-- ุฃุฒุฑุงุฑ ุญูุธ -->
  <section class="save-actions">
    <input type="text" id="mealName" placeholder="ุงุณู ุงููุฌุจุฉ (ุงุฎุชูุงุฑู)">
    <button class="btn primary" id="btnSaveMeal">ุญูุธ ุงููุฌุจุฉ ๐พ</button>
  </section>

  <!-- ููุฏุงู ููุชุจุฉ ุงูุฃุตูุงู -->
  <section id="libModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ุงูููุชุจุฉ</h3>
        <button class="btn ghost" id="closeLib">ุฅุบูุงู</button>
      </div>

      <div class="lib-grid" id="libGrid"></div>
    </div>
  </section>

  <!-- ููุฏุงู ุงูุชุญููู ูู ุงูุฌุงูุฒ -->
  <section id="presetModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ุชุญููู ูุฌุจุฉ ุฌุงูุฒุฉ</h3>
        <button class="btn ghost" id="closePreset">ุฅุบูุงู</button>
      </div>
      <div id="presetList" class="preset-list"></div>
    </div>
  </section>

  <!-- ุตูุฑ ุงูุชุฑุงุถูุฉ -->
  <img id="placeholderImg" src="./images/placeholder.png" class="hidden" alt="">

  <!-- Firebase config (ูุงุฒู ูุจูู) -->
  <script src="./firebase-config.js"></script>
  <!-- AI ุจุฏูู export -->
  <script src="./js/ai.js"></script>
  <!-- ููุทู ุงูุตูุญุฉ -->
  <script src="./js/meals.js"></script>
</body>
</html>
